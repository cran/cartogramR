
R Under development (unstable) (2021-08-27 r80829) -- "Unsuffered Consequences"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## gsm
> 
> library(cartogramR)
> data(usa)
> usa2 <- usa[usa$region=="4",]
> oldoptions <- options(digits=5)
> precarto <- precartogramR(usa2, gridpower2=5:8)
> summary(precarto)
           L32    L64   L128   L256
Min.    17.000  71.00 283.00 1126.0
1st Qu. 22.000  90.50 361.00 1451.0
Median  28.000 102.00 409.00 1650.0
Mean    26.909 107.55 430.45 1726.1
3rd Qu. 28.500 115.50 470.00 1881.5
Max.    41.000 161.00 645.00 2585.0
> 
> carto <-  cartogramR(usa2, "electors64", method="gsm", options=list(L=128, relerror=1.5))
> carto$final_centers
          [,1]     [,2]
 [1,]  -443567 -1057226
 [2,]  -579890   247874
 [3,]  -748697  -446100
 [4,] -1350833   181594
 [5,] -1353014   530740
 [6,]  -851097    89070
 [7,]  -509617  -111096
 [8,]  -409854  -573005
 [9,]  -752549 -1037415
[10,]  -985563  -330895
[11,] -1476536  -551108
> carto$final_area
 [1] 1.8674e+11 1.9896e+11 1.3609e+11 2.7295e+11 2.5785e+11 1.4582e+11
 [7] 1.3220e+11 2.0452e+11 2.2953e+11 2.5980e+11 1.0560e+12
> carto$cartogram[[10]]
MULTIPOLYGON (((-873359 -660535, -873246 -656228, -873065 -649551, -873063 -649337, -873075 -648366, -872920 -643860, -872823 -640429, -872712 -636402, -872507 -626645, -872429 -623313, -872372 -619824, -872320 -616903, -872278 -614865, -872183 -608171, -872126 -602821, -872068 -598393, -872011 -592800, -871914 -587029, -871870 -583745, -871866 -583457, -871828 -580919, -871797 -578179, -871768 -575886, -871754 -574786, -871745 -574146, -871730 -573064, -871718 -572211, -871707 -571470, -871692 -570484, -871696 -569996, -871658 -569265, -871587 -568148, -871542 -566414, -871517 -564714, -871483 -563624, -871497 -561933, -871508 -561057, -871502 -560609, -871491 -557912, -871446 -553495, -871426 -551091, -871370 -543318, -871343 -540753, -871331 -539437, -871277 -533645, -871254 -531311, -871231 -528992, -871213 -527321, -871178 -525135, -871097 -518992, -871032 -513092, -870951 -508873, -870881 -502006, -870798 -496401, -870732 -492713, -870696 -490356, -870561 -482908, -870470 -479603, -870466 -479208, -870422 -476241, -870366 -474200, -870278 -471064, -870189 -467746, -870153 -466409, -870098 -464366, -870029 -461801, -869927 -458406, -869875 -457035, -869815 -454811, -869751 -452431, -869656 -449416, -869616 -448048, -869539 -445727, -869514 -444784, -869474 -443578, -869375 -442606, -869307 -440343, -869255 -438588, -869214 -437310, -869166 -435764, -868968 -429450, -868942 -428718, -868909 -427819, -868887 -427198, -868780 -424635, -868648 -421658, -868559 -419637, -868385 -415716, -868337 -414614, -868283 -413420, -868162 -410707, -868136 -410130, -868046 -408118, -868010 -407309, -867926 -405444, -867879 -404415, -867843 -403603, -867825 -403221, -867815 -402997, -867721 -401089, -867584 -398504, -867500 -396935, -867370 -394525, -867339 -393916, -867240 -392111, -867190 -391179, -867152 -390475, -867109 -389682, -867059 -388760, -867006 -387777, -866933 -386445, -866869 -385262, -866777 -383571, -866676 -381707, -866517 -378807, -866448 -377580, -866391 -376475, -866292 -374541, -866234 -373397, -866162 -372161, -866121 -371474, -865930 -368273, -865775 -365703, -865637 -363414, -865526 -361576, -865421 -359836, -865359 -358819, -865315 -358100, -865264 -357260, -865110 -354741, -865005 -353101, -864875 -351095, -864764 -349055, -864718 -348284, -864501 -345321, -864248 -341738, -864094 -339479, -863889 -336503, -863611 -332633, -863344 -328978, -863191 -326889, -863157 -326341, -863102 -325502, -862987 -323865, -862868 -322250, -862801 -321358, -862759 -320778, -862654 -319353, -862615 -318820, -862481 -317160, -862375 -315479, -862291 -314469, -862205 -313305, -861910 -309340, -861672 -306148, -861561 -304733, -861474 -303552, -861291 -300983, -861075 -298161, -860983 -296919, -860789 -294346, -860604 -291933, -860547 -291192, -860459 -289880, -860279 -287590, -859998 -284519, -859857 -282516, -859600 -278972, -859521 -277821, -859511 -277701, -859502 -277604, -859472 -277294, -859427 -276776, -859027 -271734, -858603 -266453, -858487 -265002, -858333 -263139, -858050 -259429, -857963 -258317, -857917 -257724, -857846 -256814, -857758 -255741, -857706 -255037, -857675 -254634, -857662 -254455, -857634 -254079, -857556 -252809, -857435 -251611, -857114 -247524, -856324 -237190, -856237 -236014, -855984 -232598, -855915 -231659, -855811 -230273, -855761 -229666, -855512 -226324, -854895 -218130, -854533 -213168, -854315 -210226, -854144 -207956, -854021 -206286, -853903 -204846, -853790 -203404, -853467 -199292, -853224 -196182, -853095 -194435, -852884 -191535, -852853 -191110, -852476 -186031, -852334 -184141, -852269 -182918, -852070 -180156, -851760 -176142, -851609 -174160, -851369 -171178, -851159 -168370, -850826 -163831, -850653 -161569, -850529 -159968, -850361 -157605, -849849 -150079, -849559 -147299, -849439 -145694, -849218 -142437, -848997 -139147, -848898 -137672, -848818 -136341, -851289 -135703, -854264 -134956, -855471 -134652, -858690 -133838, -861833 -133016, -862195 -132924, -863987 -132437, -864588 -132272, -865783 -131949, -868697 -131152, -870005 -130795, -871427 -130406, -874337 -129713, -876497 -129176, -879118 -128447, -880678 -127980, -881127 -127825, -882124 -127500, -882700 -127319, -883738 -126985, -884414 -126769, -887931 -125618, -890646 -124686, -891971 -124252, -894640 -123556, -897820 -122846, -902187 -121866, -904327 -121351, -908956 -120039, -910515 -119597, -913259 -118811, -915197 -118245, -917058 -117663, -918350 -117313, -919467 -117004, -919769 -116918, -922587 -116087, -924594 -115481, -927691 -114571, -930473 -113749, -931486 -113444, -934461 -112547, -937235 -111671, -938640 -111277, -942058 -110278, -943412 -109882, -946427 -108993, -949922 -107948, -952137 -107163, -953712 -106680, -956029 -105962, -958668 -105173, -958991 -105084, -959197 -105027, -959320 -104993, -960822 -104595, -962815 -103984, -965864 -103046, -967120 -102661, -968775 -102150, -969721 -101858, -971758 -101235, -974935 -100288, -978491 -99208, -980664 -98623, -982548 -98037, -984738 -97345, -987088 -96602, -987946 -96329, -988776 -96061, -989543 -95790, -992366 -94914, -993432 -94603, -995863 -93856, -1000980 -92215, -1004078 -91243, -1005425 -90817, -1008613 -89824, -1012426 -88643, -1014717 -87928, -1018704 -86730, -1021124 -85875, -1023846 -85028, -1030080 -83099, -1033837 -81999, -1037684 -80843, -1041491 -79697, -1044576 -78774, -1047256 -77964, -1051306 -76749, -1052805 -76305, -1054315 -75865, -1054962 -75680, -1057957 -74806, -1061788 -73676, -1063047 -73328, -1064208 -72978, -1069134 -71483, -1070745 -70999, -1073044 -70312, -1074570 -69852, -1077595 -68969, -1081823 -67725, -1083616 -67192, -1086037 -66480, -1088672 -65706, -1090419 -65183, -1091594 -64842, -1095084 -63828, -1095914 -63593, -1096340 -63471, -1098533 -62849, -1099286 -62635, -1101807 -61918, -1106103 -60694, -1111088 -59252, -1115207 -58076, -1117891 -57310, -1120216 -56646, -1122590 -55980, -1125316 -55220, -1128968 -54197, -1132548 -53209, -1136721 -52062, -1145223 -49757, -1150891 -48255, -1159099 -45884, -1161654 -45189, -1167670 -43454, -1176414 -40927, -1186825 -37967, -1198867 -34577, -1206464 -32352, -1213051 -30479, -1215660 -29718, -1220192 -28435, -1222632 -27721, -1226974 -26435, -1233818 -24444, -1237775 -23319, -1242538 -21955, -1249684 -19868, -1252169 -19132, -1256913 -17758, -1261538 -16442, -1266423 -15006, -1269775 -13973, -1272637 -13122, -1278304 -11474, -1283075 -10080, -1287990 -8684, -1290718 -7902.2, -1294658 -6793.6, -1297311 -6188.9, -1298003 -11094, -1298566 -15045, -1299569 -22321, -1300197 -27596, -1301615 -38298, -1302153 -42915, -1303154 -50293, -1303747 -54766, -1303925 -56270, -1304380 -60057, -1304637 -62169, -1305285 -67408, -1305995 -73651, -1306501 -78385, -1306782 -81438, -1307063 -84034, -1307166 -84977, -1307563 -88692, -1307808 -90874, -1307872 -91412, -1308076 -93129, -1308935 -100129, -1309498 -104442, -1310292 -110585, -1310792 -114499, -1311332 -118545, -1311389 -118954, -1311870 -122982, -1312201 -125588, -1312646 -128796, -1313323 -134440, -1313946 -139552, -1314515 -144121, -1314615 -144849, -1314923 -147035, -1315489 -151508, -1315802 -153652, -1317225 -162920, -1317710 -165959, -1317972 -167454, -1318542 -170475, -1319261 -173854, -1319635 -175712, -1319759 -176382, -1320387 -179958, -1320768 -182035, -1320964 -183076, -1321848 -187471, -1322924 -192446, -1323650 -195494, -1324149 -197396, -1324352 -198112, -1324726 -199500, -1324969 -200405, -1325237 -201437, -1325803 -203478, -1327327 -208887, -1328247 -211981, -1328445 -212622, -1328622 -213196, -1329438 -215765, -1330459 -218617, -1330886 -219888, -1332492 -224359, -1333675 -227688, -1334554 -230095, -1335114 -231738, -1336183 -234601, -1337511 -238619, -1339260 -242995, -1339694 -243975, -1340563 -246060, -1341356 -248040, -1342133 -250011, -1343493 -253012, -1344824 -256036, -1345579 -257960, -1345922 -258734, -1346440 -259909, -1346759 -260633, -1346980 -261133, -1348157 -263707, -1348611 -264607, -1348770 -264922, -1350027 -267117, -1351778 -270270, -1353335 -273072, -1353870 -274036, -1355508 -277225, -1356870 -279929, -1357438 -281055, -1357516 -281208, -1358793 -283743, -1359733 -285613, -1361109 -288664, -1362222 -290588, -1365099 -295911, -1370287 -304960, -1372350 -308549, -1375471 -313981, -1376589 -315767, -1371846 -318392, -1370721 -319008, -1368859 -320016, -1368157 -320437, -1367905 -320592, -1367151 -321027, -1363475 -323221, -1362742 -323659, -1358058 -326429, -1355544 -327886, -1353929 -328805, -1351680 -330139, -1347662 -332443, -1343751 -334684, -1341939 -335728, -1335833 -339569, -1333841 -340810, -1332222 -341814, -1330947 -342614, -1328240 -344313, -1326930 -345139, -1322210 -347962, -1317785 -350744, -1317244 -351107, -1311840 -354822, -1310827 -355464, -1307589 -357732, -1306138 -358837, -1300558 -363168, -1296266 -366269, -1292711 -368809, -1285547 -374036, -1282024 -376601, -1279051 -378790, -1274695 -382462, -1271543 -385348, -1267853 -388841, -1262496 -393679, -1262309 -393841, -1260829 -395293, -1254568 -400611, -1251447 -403670, -1249183 -405929, -1246087 -408896, -1240777 -414136, -1239529 -415598, -1236349 -418957, -1234071 -421426, -1230095 -426180, -1228479 -428224, -1222887 -434769, -1220598 -437422, -1219270 -438951, -1216490 -442201, -1215346 -443499, -1213620 -445437, -1211617 -447676, -1207420 -453623, -1204747 -457552, -1202761 -460355, -1200962 -462867, -1200456 -463567, -1198951 -465633, -1198060 -466880, -1197858 -467159, -1196978 -468362, -1194857 -471186, -1193788 -472617, -1193220 -473352, -1192135 -474875, -1191811 -475343, -1189962 -478006, -1189580 -478544, -1187604 -481317, -1186222 -483226, -1185380 -484378, -1184806 -485158, -1184021 -486271, -1183574 -487145, -1183315 -487646, -1182598 -488845, -1182017 -489800, -1181435 -490751, -1180801 -491704, -1180043 -492983, -1179149 -494318, -1175147 -501007, -1171937 -505845, -1170643 -508087, -1169693 -509714, -1168016 -512544, -1167349 -513661, -1165670 -516442, -1165000 -517539, -1164185 -518808, -1163015 -520667, -1161737 -522683, -1160321 -524556, -1159333 -525964, -1157418 -529688, -1151728 -540594, -1148536 -546351, -1146892 -549144, -1141152 -559388, -1134971 -571137, -1130141 -580699, -1129624 -581687, -1129291 -582319, -1127975 -584873, -1126012 -588669, -1124120 -592601, -1119115 -602325, -1117398 -605463, -1115877 -608307, -1114351 -611338, -1113193 -613885, -1109916 -621081, -1108624 -624028, -1107962 -625522, -1106468 -628835, -1103473 -635274, -1102881 -636517, -1098376 -645633, -1093170 -656194, -1089582 -664772, -1089178 -665731, -1086342 -672139, -1083134 -679412, -1080653 -684722, -1080430 -685151, -1078929 -688499, -1077555 -691461, -1072682 -701591, -1070716 -706274, -1070104 -707732, -1069364 -709479, -1067512 -713764, -1066875 -715208, -1065802 -717691, -1065559 -718273, -1063904 -722231, -1063388 -723372, -1063047 -724163, -1062649 -725080, -1062321 -725832, -1060882 -729106, -1058757 -733799, -1058345 -734693, -1057102 -737456, -1054687 -742598, -1054170 -743676, -1053188 -745714, -1052819 -746474, -1052362 -747347, -1051663 -748761, -1051253 -749607, -1051014 -750168, -1050479 -751473, -1048413 -756534, -1044523 -765707, -1039783 -776318, -1039222 -777584, -1038946 -778162, -1038703 -778685, -1037794 -780627, -1037374 -781511, -1036996 -782311, -1036874 -782567, -1036658 -783015, -1036353 -783657, -1036278 -783805, -1035557 -785301, -1033216 -790299, -1032082 -792682, -1028082 -801369, -1025750 -806720, -1023459 -811798, -1020935 -817245, -1020707 -817733, -1020056 -819117, -1019192 -820990, -1018563 -822340, -1018479 -822522, -1018175 -823167, -1015905 -827931, -1014471 -830924, -1012136 -835617, -1011592 -836651, -1010824 -838174, -1009793 -840252, -1008649 -842537, -1007776 -844250, -1006270 -847323, -1004741 -850617, -1003638 -853221, -1001726 -857351, -1000365 -860223, -999638 -861579, -999319 -862084, -996950 -867003, -995996 -868860, -991511 -877523, -989829 -880680, -988183 -883727, -987454 -885058, -986698 -886434, -985481 -888680, -982905 -893581, -981169 -896883, -980077 -899042, -979536 -900116, -978245 -902654, -977170 -904736, -975574 -907888, -974875 -909254, -974292 -910362, -973163 -912509, -971985 -914696, -970920 -916675, -970045 -918298, -969153 -919943, -968161 -921732, -967457 -922987, -967384 -921185, -966766 -919129, -965630 -917463, -965127 -916867, -963462 -915602, -962661 -915150, -961195 -913494, -961004 -912333, -961258 -911451, -962002 -910305, -963279 -909232, -963889 -908876, -964149 -908604, -964256 -908383, -964377 -907714, -963301 -906613, -962428 -905840, -961879 -905453, -961154 -905180, -960562 -905018, -960192 -905041, -959850 -905091, -958738 -905207, -956779 -904914, -955650 -904256, -954743 -902994, -954543 -901953, -953315 -899405, -952989 -898460, -952658 -897130, -952333 -895568, -952163 -894479, -952047 -893980, -952060 -893214, -952373 -892229, -951932 -889509, -951475 -887888, -951366 -886324, -950902 -884515, -950777 -882391, -950606 -879790, -950170 -877952, -948939 -872458, -948797 -869616, -949071 -866110, -948725 -863187, -949053 -861442, -950466 -857606, -950828 -855097, -950644 -853516, -950463 -852151, -950428 -850815, -950477 -849200, -950341 -848070, -950209 -847517, -949776 -846449, -949409 -845636, -948930 -845141, -948044 -844831, -947226 -843937, -946639 -842639, -946740 -841896, -946438 -840440, -946124 -838796, -946025 -837840, -946687 -836111, -945689 -835539, -944901 -835329, -944395 -834694, -943697 -833435, -943513 -832592, -943372 -830938, -943967 -830132, -944027 -829000, -944288 -827170, -944620 -826414, -945106 -825509, -944946 -824725, -944622 -823311, -943826 -822323, -942940 -820728, -943175 -819715, -944121 -818174, -944375 -817011, -944060 -815947, -943574 -815070, -943155 -814332, -942613 -813231, -942271 -812311, -942097 -811632, -942054 -811082, -942015 -810881, -941428 -809963, -941606 -808372, -941251 -806871, -940642 -805145, -941112 -803134, -940823 -801985, -940062 -801358, -939324 -800108, -938772 -799183, -939024 -797892, -939099 -797532, -939134 -796575, -937983 -795976, -937123 -795178, -936234 -795022, -935556 -794938, -934962 -794620, -934602 -794059, -934910 -793602, -935547 -791797, -936558 -789885, -936718 -789033, -936949 -787925, -936939 -786793, -936618 -786025, -936572 -784670, -936664 -784148, -936792 -783001, -936926 -781931, -936984 -781424, -937099 -780434, -937054 -779731, -937557 -776458, -936923 -775445, -936829 -774332, -936590 -772844, -936310 -772373, -935877 -771980, -935253 -771587, -934335 -770208, -935343 -768969, -934977 -767167, -934451 -765924, -934921 -763458, -935065 -762194, -933302 -759919, -931505 -759695, -930628 -759847, -929648 -759727, -929120 -759732, -928488 -760289, -927806 -759703, -926606 -759319, -924798 -757876, -923473 -757065, -923153 -758656, -922812 -759074, -920830 -757847, -919530 -757584, -917618 -757378, -916848 -757777, -915541 -758669, -914733 -758626, -914087 -758705, -913449 -759784, -914416 -761370, -914194 -762083, -910395 -761541, -909610 -763775, -906849 -761708, -904684 -763212, -904184 -763048, -903231 -766048, -902209 -768881, -901445 -770263, -900985 -772000, -900892 -774614, -901572 -776264, -900597 -776634, -899431 -778597, -898996 -778674, -898679 -781423, -897407 -783614, -896950 -783981, -896114 -784104, -894905 -784358, -893634 -784222, -892116 -783698, -890996 -784026, -889982 -784341, -889127 -782961, -888405 -779783, -886841 -776593, -886594 -775259, -886818 -773731, -885528 -772918, -884708 -771962, -883219 -768460, -882080 -765872, -881032 -764710, -880341 -764517, -880228 -763476, -879973 -761148, -879733 -759026, -879556 -757415, -879425 -755732, -879282 -753755, -879133 -752146, -879005 -750962, -878704 -748563, -878529 -746226, -878011 -741369, -877769 -739148, -876889 -729205, -876707 -726012, -876500 -722557, -876339 -720014, -876186 -717520, -875997 -714281, -875809 -710915, -875632 -707850, -875253 -700962, -874866 -694074, -874760 -691686, -874542 -688016, -874438 -685838, -874436 -685809, -874377 -684509, -874332 -683578, -874320 -683327, -874288 -682704, -874265 -682263, -873951 -675534, -873800 -672300, -873507 -666061, -873359 -660535)))
> summary(carto)
* Objective:
  - Relative error:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0263  0.1115  0.2589  0.3292  0.3225  1.4740 
  - Error:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
3.93e+09 1.65e+10 5.45e+10 7.47e+10 6.09e+10 3.44e+11 

* Distortion of regions
  Symmetrized difference error
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0964  0.1311  0.1513  0.1677  0.1884  0.2986 
> 
> poiY <- sf::st_sfc(sf::st_point(c(-1946151, -538753)))
> sf::st_crs(poiY) <- sf::st_crs(usa2)
> poiYb <- geom_cartogramR(poiY, carto)
> print(sf::st_coordinates(poiY))
         X       Y
1 -1946151 -538753
> 
> Y <- matrix(c(-1901626,-1935314,-1929683,-1898426,-1901626,-444869,-454442,-484786,-460618,-444869),5,2)
> polY <- sf::st_sfc(sf::st_polygon(list(Y)), check_ring_dir = TRUE)
> sf::st_crs(polY) <- sf::st_crs(usa2)
> polYb <- geom_cartogramR(polY, carto)
> print(sf::st_coordinates(polYb))
            X       Y L1 L2
[1,] -1881044 -400101  1  1
[2,] -1953820 -417538  1  1
[3,] -1949458 -455652  1  1
[4,] -1877692 -419256  1  1
[5,] -1881044 -400101  1  1
> 
> Y <- matrix(c(-1944542,-1927687,-1890629,-1821631,-1799218,-1783629,-1766393,-1745082,-539743,-517879,-485451,-458782,-443586,-424518,-417270,-414516),8,2)
> linY <- sf::st_sfc(sf::st_linestring(Y))
> sf::st_crs(linY) <- sf::st_crs(usa2)
> linYb <- geom_cartogramR(linY, carto)
> print(sf::st_coordinates(linYb))
            X       Y L1
[1,] -1989044 -528674  1
[2,] -1953077 -497795  1
[3,] -1866530 -448675  1
[4,] -1691812 -396541  1
[5,] -1629728 -371774  1
[6,] -1585085 -345623  1
[7,] -1539243 -332676  1
[8,] -1484712 -323714  1
> 
> delta <- c(43000, 50000)
> p1 <- matrix(c(-1944542,-1901542,-1815542,-1858542,-1901542,-1944542,-539743,-539743,-439743,-339743,-339743,-539743), ncol=2)
> p2 <- matrix(c(-1901542,-1901542,-1858542,-1901542,-489743,-439743,-439743,-489743), ncol=2)
> p3 <- matrix(c(-1815542,-1772542,-1772542,-1815542,-1815542,-539743,-539743,-489743,-489743,-539743), ncol=2)
> p4 <- matrix(c(-1802642,-1802642,-1781142,-1781142,-1802642,-524743,-499743,-499743,-524743,-524743), ncol=2)
> p5 <- matrix(c(-1815542,-1772542,-1772542,-1815542,-389743,-439743,-389743,-389743), ncol=2)
> mpolY <- as.list(1:2)
> mpolY[[1]] <- sf::st_multipolygon(list(list(p1,p2), list(p3,p4), list(p5)))
> mpolY[[2]] <- sf::st_multipolygon(list(list(p1+matrix(4*delta,nrow(p1),ncol(p1), byrow=TRUE),
+                                         p2+matrix(4*delta,nrow(p2),ncol(p2), byrow=TRUE)),
+                                    list(p3+matrix(4*delta,nrow(p3),ncol(p3), byrow=TRUE),
+                                         p4+matrix(4*delta,nrow(p4),ncol(p4), byrow=TRUE))))
> mpolY <- sf::st_sfc(mpolY,check_ring_dir = TRUE)
> sf::st_crs(mpolY) <- sf::st_crs(usa2)
> mpolYb <- geom_cartogramR(mpolY, carto)
> print(sf::st_coordinates(mpolYb))
             X       Y L1 L2 L3
 [1,] -1989044 -528674  1  1  1
 [2,] -1905805 -520596  1  1  1
 [3,] -1670769 -372381  1  1  1
 [4,] -1761008 -262256  1  1  1
 [5,] -1860464 -266552  1  1  1
 [6,] -1989044 -528674  1  1  1
 [7,] -1892170 -456704  2  1  1
 [8,] -1879666 -393632  2  1  1
 [9,] -1778738 -384244  2  1  1
[10,] -1892170 -456704  2  1  1
[11,] -1706365 -492081  1  2  1
[12,] -1597835 -473669  1  2  1
[13,] -1575744 -414717  1  2  1
[14,] -1686350 -431036  1  2  1
[15,] -1706365 -492081  1  2  1
[16,] -1667482 -468284  2  2  1
[17,] -1657199 -438156  2  2  1
[18,] -1601909 -429671  2  2  1
[19,] -1612667 -459255  2  2  1
[20,] -1667482 -468284  2  2  1
[21,] -1660811 -314840  1  3  1
[22,] -1559790 -358889  1  3  1
[23,] -1551272 -304787  1  3  1
[24,] -1660811 -314840  1  3  1
[25,] -1549818 -250707  1  1  2
[26,] -1445267 -244266  1  1  2
[27,] -1286410 -144127  1  1  2
[28,] -1396085  -38435  1  1  2
[29,] -1479980  -28546  1  1  2
[30,] -1549818 -250707  1  1  2
[31,] -1452687 -192915  2  1  2
[32,] -1462807 -139461  2  1  2
[33,] -1370808 -141734  2  1  2
[34,] -1452687 -192915  2  1  2
[35,] -1258011 -234539  1  2  2
[36,] -1183251 -232375  1  2  2
[37,] -1196286 -190006  1  2  2
[38,] -1270341 -190041  1  2  2
[39,] -1258011 -234539  1  2  2
[40,] -1237748 -220655  2  2  2
[41,] -1244215 -198740  2  2  2
[42,] -1207392 -198523  2  2  2
[43,] -1200759 -219909  2  2  2
[44,] -1237748 -220655  2  2  2
> 
> options(oldoptions)
> 
> proc.time()
   user  system elapsed 
  2.079   0.725   1.140 
